import paho.mqtt.client as mqtt
import base64
import json

APP_ID = "50981d4c-9ebd-49fc-a7d4-f88ea8598ef2"  # seu applicationId
DEV_EUI = "70b3d57ed00717ae"

def send_downlink(message):
    client = mqtt.Client()
    client.connect("localhost", 1883, 60)

    payload = {
        "confirmed": False,
        "fPort": 1,
        "data": base64.b64encode(message.encode()).decode()
    }

    topic = f"application/{APP_ID}/device/{DEV_EUI}/command/down"
    client.publish(topic, json.dumps(payload))
    client.disconnect()

if __name__ == "__main__":
    send_downlink("Hello world"
